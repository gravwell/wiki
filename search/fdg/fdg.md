# 有向グラフ

有向グラフ（fdg）モジュールは、ノードペアとオプションのグループ化を使用して有向グラフを生成するために使用されます。fdgモジュールは、結果として得られるエッジの重み値とともに、送信元と送信先のグループを受け入れます。

## サポートされているオプション
* `-b`: エッジが双方向であることを示します。つまり、[A、B]のペアは[B、A]と同じです。
* `-v <enumerated value>`: エッジは指定された列挙値の合計として重み付けされるべきであることを示します。この`-v`フラグは、エッジが生カウント以外のもので表される重みを持つ有向グラフを生成するのに役立ちます。
* `-sg <enumerated value>`: グラフの色付けに使用されるソース値に適用するグループを提供します。例えば、ソースグループは、グラフのノードをグループ化するためのIPのサブネットなどです。
* `-dg <enumerated value>`: `-sg`と同じですが、destinationパラメータに基づいてグループ化します。

## サンプルクエリ

有向グラフが有用な例として、ネットワーク上のアドレス間の関係を特定することが挙げられます。IPV4トラフィックの重み付き有向グラフを生成し、ノードをクラスCネットワークにグループ化するには、次のようなクエリを使用します:

```
tag=pcap packet ipv4.SrcIP ipv4.DstIP ipv4.Length | sum Length by SrcIP,DstIP | subnet SrcIP /24 as SrcSub | subnet DstIP /24 as DstSub | fdg -v sum -sg SrcSub -dg DstSub SrcIP DstIP
```

![](fdg1.png)

ノードの上にマウスを置くと、そのラベルとその隣のラベルが表示されます:

![](fdg2.png)

オプションメニューでは、アニメーションを有効または無効にしたり、標準の有向グラフと円グラフを切り替えたりできます:

![](fdg3.png)

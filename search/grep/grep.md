## Grep

Grepは、テキスト文字列（Unicodeではない）を検索する非常に基本的なパイプラインモジュールです。そのようなテキストを含むレコードはすべてマッチし、パイプラインを通過します。テキストを含まないレコードはパイプラインから削除されます。例えば、`grep foo` は "foo" というテキストを含むレコードを渡し、その中のどこにも "foo" が含まれていないレコードはすべて削除します。Grep は大文字小文字を区別しますので、`grep foo` は "foo" にマッチしますが、"Foo" は削除します。 また、Grepはprintfと同様にエスケープコードの標準セットをサポートしており、 バイナリフィルタも可能です。

Grepは標準的なGNUワイルドカードと高速な文字列とバイナリのマッチングをサポートしています。 0バイトかNバイトで区切られた "foo "と "bar "を含むすべてのエントリを探すには、`grep foo*bar`を使うことができます。 利用可能なワイルドカードの詳細については TLDP miniguide[1] を参照ください

Grep では、複数のパターンを指定することができます。パターンにマッチするものがあれば、そのエントリはパイプラインの下に渡されます。v` フラグを使用して検索を反転させた場合、すべてのパターンが一致した場合にはエントリは削除されます。

### サポートされているオプション

* `-v`: “「逆」グレップ。  たとえば、grep -v bar「bar」というテキストを含むレコードを削除し、「bar」を含まないレコードを検索します。
* `-i`: 大文字と小文字を区別しない値と一致します。  したがって、grep -i foo「Foo」と「foo」は一致します。  大文字と小文字を区別しない検索は最も遅い操作の1つです。  物事を速くするために、可能であれば後でそれをパイプラインに入れてください。
* `-e <arg>`: 処置：レコード全体ではなく、列挙値を操作してください。  たとえば、HTTPテキストを含むがポート80宛てではないパケットを示すパイプラインは次のようになります。 `tag=pcap packet ipv4.DstPort!=80 tcp.Payload | grep -e Payload "GET / HTTP/1.1"`
* `-s`:厳密な一致 すべてのパターンが一致する必要があります。  または、厳密な一致が否定された場合は、パターンが一致しない可能性があります。`
* `-simple`: 単純一致。  このフラグ`grep`を使用すると、ワイルドカードによるマッチングは行わずに、指定した文字と正確に一致します。  これにより、アスタリスクやその他の通常予約されている文字を見つけることができます: `grep -s * `
* `-w`: 単語の一致。  一致パターン全体は、フルテキストエクストラクターによって一致する単語でなければなりません。

重要: 大/小文字を区別しない検索はかなり遅くなります。  大文字と小文字を区別しないでgrepを実行する必要がある場合は、速度を向上させるために後で検索パイプラインに追加するようにしてください。

重要: ワイルドカードは単語の境界を越えることができるため、`-w`という単語の一致は単純な一致を意味します。

### 検索例
```
grep <argument list> <search parameter>
```

### 検索例

正確な文字列 "Mozilla * Firefox"（ワイルドカードなし）を含むApacheログを見つけるには:

```
tag=apache grep "Mozilla\*Firefox"
```

ペイロードがバイト0、1、2、3で始まるポート80上のパケットを見つけるには、次のように入力します:

```
tag=pcap packet tcp.Port==80 tcp.Payload | grep -e Payload "\x01\x02\x03\x04"
```

"ing"または "ed"で終わる単語を含むRedditの投稿と一致する:

```
tag=reddit json Body | grep -e Body "*ing" "*ed"
```

"Ask"で始まる、または "foo"を含むサブクレジットにReddit投稿をドロップします。:

```
tag=reddit json Subreddit | grep -v -e Subreddit "Ask*" "foo"
```

GMozillaとWindowsを含むユーザーエージェントだけを抽出

```
tag=apache grep -s Mozilla Windows
```

### 単語一致の使用

単語照合システムは、完全な単語を照合するように設計されています。   -wフラグ付きのGrepは、フルテキストインデックスシステムと対話するための主要な方法の1つです。

-wフラグは、値を選択するときにいくつかの追加の特異性を作成するように設計されています。いくつかのサンプルデータを見て、一致するものとしないものを確認します。

```
16.246.30.72 - - [08/May/2017:15:20:35 -0600] "DELETE /search/tag/list HTTP/1.0" 200 5032 "http://nguyen.biz/category/tags/tag/home.htm" "Opera/8.74.(Windows 98; Win 9x 4.90; it-IT) Presto/2.9.173 Version/11.00"
```

grepのいくつかの呼び出しを見て、一致するものと一致しないものを確認してみましょう:

| Grepの呼び出し | マッチ | 説明 |
|-----------------|---------|-------------|
| grep Ver        |   YES   | `Version / 11.00`バイトパターンにより、単純なgrepが一致します |
| grep -w Ver     |   NO    | Verは完全な単語ではないため、単語の一致は `Version / 11.00`パターンと一致しません |
| grep -w Ver*    |   NO    | `-w`は単純な一致を意味し、リテラルバイト`Ver *`はログにないため、単語の一致は一致しません。 |
| grep -w Version |   YES   | バージョンは完全な単語であり、 `/`文字は分割文字であるため、単語一致は一致します |
| grep -w "11.00" |   YES   | 単語は一致します。`.`文字の後にスペースが続く場合は区切り文字にすぎません。これにより、IPアドレスの一致が許可されます。 |
| grep -w "Version/11.00" |  ERROR  | The grep module will grepモジュールはエラーを表示します。マッチに単語境界文字を含めることはできません |

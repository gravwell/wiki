## DNS

注意：`dns`モジュールは、DNSリゾルバに膨大な量のネットワークトラフィックを発生させる可能性があります。短時間にあまりにも多くのリクエストを生成すると、DNSリゾルバは動作を停止するかもしれません。 

`dns`モジュールはホスト名のDNSルックアップを行い、その結果を列挙値に格納するために用いられます。`dns`モジュールはIPアドレスの逆引きを行うこともできます。デフォルトでは、`dns`モジュールは一回の検索で1024回以上のルックアップを行いません。これは、リゾルバへのDNSクエリのバーストを防ぐためです。モジュールは結果のシンプルなLRU（最少使用）キャッシュを保持しているので、重複する値が多い検索でもルックアップの制限を大きく下回ることがあります。この制限は `-l` フラグで調整できます。

この構文は、1つ以上の値のペア、ルックアップを実行する列挙値、生成する対象の列挙値を取るだけである。例えば、列挙値 "Computer"のルックアップを実行し、列挙値 "ip"に結果のIPを生成するには、以下のようになります:

```
tag=windows winlog Computer | dns Computer ip | table
```

正引きも逆引きも、複数の結果を生成することができます。複数の結果が得られた場合、出力は文字列のカンマ区切り（CSV）リストになります。結果が1つの値の場合は、要求されたタイプで生成されます（ホスト名は文字列、IPアドレスはタイプされたIPです）。

### サポートされているオプション

* `-reverse`: 列挙値をIPとして扱い、逆引きを行います。
* `-l`: 実行するルックアップの最大数を設定します。これにより、リゾルバへの偶発的なDNSクエリのバーストを防ぐことができます。既定値は1024です。

### 例

この例では、データセットからホスト名を抽出し、各ホスト名に対してDNSルックアップを行います:

```
tag=dns json Question.Hdr.Name | limit 10 | dns Name ip | table
```

![Example 1](example1.png)

また、逆引きも可能です。この例では、IPアドレスを抽出し、上記と同様のクエリを実行しますが、`-reverse` フラグを設定しています:

```
tag=dns json Question.A~"185.199" | require A | limit 10 | dns -reverse A hostname | table
```

![Example 2](example2.png)

# テンプレート

テンプレートとは、Gravwellのクエリを定義する特殊なオブジェクトです。同じ変数を使った複数のテンプレートをダッシュボードに含めることで、強力な調査ツールを作成することができます。例えば、IPアドレスを変数とするテンプレートを使って、IPアドレス調査ダッシュボードを作成することができます。

## テンプレートページ

テンプレート管理ページは、メインメニューの「ツール＆リソース」からアクセスできます:

![](template-menu.png)

![](template-page.png)

## テンプレートの作成

新しいテンプレートを作成するには、テンプレートページの右上にある`Add`ボタンをクリックします。Gravwellはテンプレートを定義するためのいくつかの値を入力します。以下の例では、ユーザーが指定したDHCPメッセージタイプを検索するテンプレートを定義しています。

![](new-template.png)

各フィールドの説明は以下の通りです。

* **クエリテンプレート**：このフィールドには、変数 `tag = syslog grep DHCP %% VAR %%`を含むクエリを入力しました。
* **クエリ内の変数名**: ここでは、変数名を定義します。ここでは、クエリで使用した変数の名前を定義します。しかし、`%%VAR%%`や`__IPADDR__`のようなユニークな名前を使うことを強くお勧めします。
* **変数のラベル**: このラベルは、ユーザーが変数への入力を求められたときに表示されます。短いですが、説明的である必要があります。
* **変数のヒント**: ここでは、ユーザーが入力することができる2つの文字列の例を示します。
* **'Require a value' checkbox**: このチェックボックスは、値を入力する必要があるかどうかを示します。クエリの中には、変数に値を入れても入れなくても有用なものがありますので、このボックスでその動作を有効にします。
* **プレビュー＆バリデーション**: これは、結果として得られるクエリをチェックするための値を入力できる *オプション* のテキストボックスです。ここでは、文字列 "ACK "を入力し、結果として得られるクエリ`tag=syslog grep DHCPACK`が適切であることを確認しています。

残りのフィールド（Name、Descriptionなど）は、Gravwellのほとんどのオブジェクトに共通しているので、説明の必要はありません。

テンプレートが正しく定義されたら、"保存"をクリックして、メインのテンプレートページに戻ります。

## テンプレートを実行します

テンプレートのカードにある検索アイコンをクリックすると、テンプレートのクエリを実行することができます。

![](run-template.png)

変数の値を入力するためのダイアログが表示されます。

![](template-prompt.png)

ここでは、過去1時間のDHCP *REQUEST*メッセージを検索したいと考え、フィールドに「REQUEST」と入力し、時間枠のドロップダウンを変更します。

![](template-prompt2.png)

起動」をクリックすると、検索が開始されます。ページの一番上にテンプレートのクエリが表示され、変数（`%%VAR%%`）が私たちの与えた文字列に置き換えられているのがわかります。

![](template-results.png)

## テンプレートの編集と削除

テンプレートを変更するには、テンプレートのタイルにある編集アイコン（鉛筆）をクリックします。テンプレートを削除するには、削除（ゴミ箱）アイコンをクリックします。

![](edit-delete.png)

## テンプレートの共有

Gravwellのほとんどのオブジェクトと同様に、テンプレートは所有者のみが閲覧可能、1つ以上のグループで共有、またはグローバルに共有（管理者のみ）という設定が可能です。この設定はテンプレートエディタのPermissionsタブで行います。

![](permissions.png)

## ダッシュボードでのテンプレートの使用

テンプレートは、ダッシュボードのタイルに埋め込むことができます。ダッシュボードが読み込まれたときに、ユーザーは変数の値を入力するよう求められます。ダッシュボードにテンプレートを追加する手順については、[ダッシュボードのドキュメントページ](#!gui/dashboards/dashboards.md)を参照してください。

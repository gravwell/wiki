# 持続的検索

Gravwellでは、[長時間実行する検索をバックグラウンドに送る、または検索結果を保存する](#!gui/queries/queries.md)、または[検索をスケジュールする](#!scripting/scheduledsearch.md)ことで、定期的に検索を実行することができます。検索結果を後で確認するには、メインメニューの[検索]セクションにある、*Persistent Searches*ページを使用します。

![](persistent-menu.png)

Persistent Searchページは定期的に更新され、現在の状態が表示されます。このページには、ユーザーに属する検索やユーザーと共有されている検索が表示されます。以下のスクリーンショットでは、2つの検索が表示されています。

![](persistent.png)

一番上の検索は、1分前にユーザーが手動で実行したものです。"ACTIVE"の状態で、1つのクライアントが接続されていることがわかります。つまり、ユーザーはまだ別のブラウザタブで検索を表示しているということです。検索結果は、ディスク上で328バイトを消費しています。

2つ目の検索は、"Run By"欄に"Agent"と表示されているように、検索エージェントによって実行されました。このエージェントは DORMANT 状態であり、削除されるかウェブサーバが再起動するまで検索結果が利用可能であることを意味しています。

## 検索の状態

Gravwellのすべての検索には*状態*がありますが、この状態は通常ユーザーには表示されません。しかし、永続的検索ページで検索を管理する際に状態を知っておくと便利なので、ここでは表示しています。状態には以下のものがあります。

* ACTIVE：検索が実行されているか、実行が完了したばかりで、まだクライアント（通常はユーザーのブラウザ）が接続されている状態です。
* DORMANT：検索が完了し、クライアントが接続されていません。再び開くことはできますが、ウェブサーバの再起動後も検索結果が継続することは保証されません。バックグラウンドの検索は、完了すると DORMANT と表示されます。
* ATTACHED：検索が完了して休止状態になっていたが、クライアントが再び接続してきた状態です。

"DORMANT/SAVED"のように、ユーザが明示的に保存を指定した検索には、SAVEDフラグが付加されます。 検索結果はウェブサーバが再起動しても保存されます。活動中の検索には「ACTIVE/SAVING」と表示されますが、これは検索がまだ完了しておらず、完全には保存されないためです。

ACTIVE検索にはBACKGROUNDEDというフラグがあり、"ACTIVE/BACKGROUNDED"や"ACTIVE/SAVING/BACKGROUNDED"などと表示されることがあります。これは、ユーザーが検索をバックグラウンドに送り、後で見直すことを意味する。検索がバックグラウンドになっていない場合、ユーザーがアクティブな検索結果ページから離れてナビゲートすると、その検索はキャンセルされ、削除されます。

検索の保存とバックグラウンド化の詳細については、[search interface documentation](#!gui/queries/queries.md)を参照してください。

## 結果の表示

検索結果を表示するには、その検索結果の行の右端にある"View Results"アイコンをクリックします。

![](view-results.png)

これは検索の再実行ではなく、ウェブサーバのディスクに保存されている前回の検索結果を読み込むことに注意してください。つまり、元のデータが[age out](!#configuration/ageout.md)された非常に古い検索結果も表示することができるのです。

## メモの追加

ノートの追加」アイコンをクリックすると、永続検索ページの検索結果にノートを追加できます。ダイアログが開き、検索の名前と簡単なメモを入力できます。

![](add-notes.png)

![](add-notes2.png)

メモを保存すると、定義した名前がクエリ文字列の上に表示されます。メモを追加すると、自動的に検索結果が「SAVED」となりますので、ご注意ください。

![](add-notes3.png)

## 追加アクション

永続検索ページの検索結果には、追加アクションのメニューがあり、3つの縦のドットが表示されたアイコンからアクセスできます。

![](additional.png)

* Save query: クエリストリングを[クエリライブラリ](#!gui/querylibrary/querylibrary.md)に保存します。
* Copy query:クエリ文字列をクリップボードにコピーします。
* Save：検索結果を保存します。検索結果を保存します。
* Schedule:そのクエリを使って新しい[sccheduledsearch](#!scripting/scheduledsearch.md)を作成するページを表示します。
* Background: 背景を表示します。アクティブな検索に対して、バックグラウンドであることを示します。
* Delete: 検索結果をシステムから削除します。

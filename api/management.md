# システム管理

このページでは、Gravwellのプロセスや設定を管理するための、管理者専用のAPIを説明します。

## Gravwellの再起動

Gravwellのプロセスを再起動するためのAPIが2つ用意されています。1つはウェブサーバの再起動、もう1つはインデクサの再起動です。どちらの場合も、プロセスをシャットダウンしてsystemd（または使用しているinitシステム）に再起動させることで「再起動」が行われます。

### ウェブサーバの再起動

ウェブサーバを再起動するには、空のボディを持つ POST リクエストを `/api/restart/webserver` に送信します。これにより、ウェブサーバは直ちにシャットダウンして再起動します。

### インデクサーの再起動

ウェブサーバが現在接続しているすべてのインデクサを再起動するには、`/api/restart/indexers` にボディが空の POST リクエストを送信します。ウェブサーバは、各インデクサに対してシャットダウンと再起動のシグナルを送ります。個々のインデクサーが復旧すると、ウェブサーバは自動的に再接続します。

### 分散型フロントエンドの確認とデプロイメント情報の確認

Gravwellクラスタが分散フロントエンドモードで動作しているかどうかを確認するには、`/api/deployment`に対してGETを実行します。 ウェブサーバからは、フロントエンドが分散モードで設定されているかどうかを示すJSONオブジェクトが返信されます。

分散モードでない場合のレスポンス例:

```
{
	"Distributed": false,
	"DefaultLanguage": "en_US",
}
```


### システムバックアップの実行

管理者ユーザーは、システムバックアップを要求すると、Gravwell の状態に関連するすべての コンテンツを含むバックアップファイルが提供されます。

システムバックアップには、ユーザーやグループのアカウント、ダッシュボード、キット、クエリライブラリ、保存された検索結果などが含まれます。 これは基本的にデータとシステム設定以外のすべてのものである。

バックアップを取得するには、管理者ユーザーとして `/api/backup` に `GET` リクエストを実行すると、API はバックアップファイルのダウンロードを返します。

デフォルトでは、バックアップには保存された検索が含まれていません。保存された検索をバックアップに含めるには、GETリクエストに `savedsearch=true` というURLパラメータを追加します。

`api/backup` APIは、JWT認証トークンまたはクッキーを使って認証することができます。

注： バックアップやリストアは、一度に一回しか実行できません。

### システムバックアップからのリストア

管理者ユーザーは `/api/backup`API に対して `POST` を実行し、マルチパートフォームを使ってバックアップファイルをアップロードすることで、バックアップアーカイブからシステムを復元することができます。

APIはバックアップファイルが `backup`フォームフィールドに置かれ、マルチパートフォームを使ってアップロードされることを期待している。

`api/backup` APIは、JWT認証トークンまたはクッキーを使って認証することができます。

注： 復元は完全な復元であり、復元ポイント以降に行われたユーザー、コンテンツ、保存された検索への変更はすべて失われます。

注：一度に実行できるバックアップや復元は1つだけです。

注：リストアを開始すると、すべてのセッションが終了します。 復元が正常に完了すると、すべてのユーザーが再ログインする必要があります。
